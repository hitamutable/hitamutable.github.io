<!DOCTYPE html>
<html>
  <head>
    <title>Auto like bot</title>
    <script src="./500px.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  </head>
  <body>
    <script>
      $(function () {
        _500px.init({
          sdk_key: '92e0ebba2f64a8e25bb1def13436fc0268993b8b'
        });

        // When the user logs in we will pull their favorite photos
        _500px.on('authorization_obtained', function () {
          $('#not_logged_in').hide();
          $('#logged_in').show();

          _500px.api('/photos', { feature: 'upcoming' }, function (response) {
            if (response.data.photos.length == 0) {
              alert('Photos not found.');
            } else {
              var count = 0;
              $.each(response.data.photos, function (idx, photo) {
                // Vote up a photo
                _500px.api('/photos/' + photo.id + '/vote', 'post', {vote: 1}, function (response) {
                  count = response.success ? count + 1 : count;
                  var msg = response.success ? "Voted" : response.error_message;
                  var img = '<img src="' + photo.image_url + '" width="100" />';
                  var url = '<a href="https://500px.com/' + photo.url + '">' + photo.name + '</a>';
                  var gear = 'Body: ' + photo.camera + '<br>Lens: ' + photo.lens;
                  var exif = photo.focal_length + ' mm, ' +
                             'iso ' + photo.iso + ', ' +
                             'f ' + photo.aperture + ', ' +
                             photo.shutter_speed + ' s';
                  var row =
                    '<tr>' +
                      '<td>' + photo.taken_at + '</td>' +
                      '<td>' + img + '</td>' +
                      '<td>' + url + '</td>' +
                      '<td>' + gear + '</td>' +
                      '<td>' + exif + '</td>' +
                      '<td>' + msg + '</td>' +
                    '</tr>';
                  
                  $('#logged_in #table tbody:last-child').append(row);
                });
              });
              $('#logged_in #result').append('<h4>' + count + " liked" +'</h4>');
            }
          });
        });

        _500px.on('logout', function () {
          $('#not_logged_in').show();
          $('#logged_in').hide();
          $('#logged_in').html('');
        });

        // If the user has already logged in & authorized your application, this will fire an 'authorization_obtained' event
        _500px.getAuthorizationStatus();

        // If the user clicks the login link, log them in
        $('#login').click(_500px.login);
      });
    </script>
      
    </div>

    <div class="container">
      <div class="row">
          <div class="col-sm-12">
            <h1>Auto like photos on 500px</h1>

            <div id="not_logged_in">
              <a href="#" id="login">Login to 500px</a>
            </div>
            <div id="logged_in" style="display: none;">
              <div id="result"></div>
              <div id="table">  
                 <table class="table table-bordered table-hover">
                  <tbody>
                    <tr>
                     <th>Taken Date</th>
                     <th>Thumbnail</th>
                     <th>Name</th>
                     <th>Gears</th>
                     <th>Exif</th>
                     <th>Message</th>
                   </tr>
                  </tbody>     
                 </table>
               </div>
            </div>
          </div>
      </div>

    </div>
    
  </body>
</html>
